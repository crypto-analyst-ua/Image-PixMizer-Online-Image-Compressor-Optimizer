<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upgrade to Premium - Image PixMizer</title>
  <script src="https://www.sandbox.paypal.com/sdk/js?client-id=ATnZIAG3susq8624ujWJL8C5iu3D_1C6lQeYkuESE8VE_v7qonBxxeSFICHlY3dOq9XQD8GwAHne2Uwf&currency=USD"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ==== ТВОЙ CSS БЕЗ ИЗМЕНЕНИЙ ==== */
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; }
    body { background:linear-gradient(135deg,#1a1a2e,#16213e); min-height:100vh; display:flex; justify-content:center; align-items:center; padding:20px; color:#fff; line-height:1.6; }
    .container { width:100%; max-width:1000px; background:linear-gradient(145deg,#0f3460,#1a1a2e); border-radius:20px; box-shadow:0 15px 35px rgba(0,0,0,0.5); overflow:hidden; border:1px solid rgba(255,255,255,0.1); }
    .header { background:linear-gradient(135deg,#0d7377,#14ffec); color:#0f3460; padding:40px 30px 30px; text-align:center; position:relative; clip-path:polygon(0 0,100% 0,100% 90%,0 100%); }
    .logo { position:absolute; top:20px; left:30px; font-size:1.8rem; font-weight:bold; display:flex; align-items:center; gap:10px; }
    .logo i { color:#ffd700; background:rgba(0,0,0,0.2); padding:8px; border-radius:10px; }
    .header h1 { font-size:2.8rem; margin:15px 0 10px; text-shadow:0 2px 4px rgba(0,0,0,0.2); }
    .header p { font-size:1.2rem; max-width:700px; margin:0 auto 25px; font-weight:500; }
    .plans { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:30px; padding:40px 30px 30px; }
    .plan { background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:20px; padding:35px 30px; transition:all 0.4s ease; text-align:center; position:relative; backdrop-filter:blur(10px); box-shadow:0 10px 25px rgba(0,0,0,0.2); }
    .plan:hover { transform:translateY(-10px); border-color:rgba(20,255,236,0.3); }
    .plan.premium { border-color:#ffd700; background:linear-gradient(145deg,rgba(255,215,0,0.1),rgba(255,215,0,0.05)); box-shadow:0 15px 35px rgba(255,215,0,0.15); }
    .recommended-badge { position:absolute; top:-15px; left:50%; transform:translateX(-50%); background:linear-gradient(to right,#ff9a00,#ffd700); color:#0f3460; padding:8px 25px; border-radius:30px; font-weight:bold; font-size:0.9rem; box-shadow:0 5px 15px rgba(255,215,0,0.3); z-index:2; }
    .plan h2 { font-size:2rem; margin-bottom:25px; color:#14ffec; }
    .price { font-size:3.5rem; font-weight:bold; margin-bottom:25px; color:#fff; position:relative; display:inline-block; }
    .price::before { content:''; position:absolute; width:100%; height:3px; background:linear-gradient(to right,transparent,#14ffec,transparent); bottom:-10px; left:0; border-radius:3px; }
    .premium .price { color:#ffd700; }
    .features { list-style:none; padding:0; margin-bottom:35px; text-align:left; }
    .features li { padding:12px 0; border-bottom:1px solid rgba(255,255,255,0.1); display:flex; align-items:center; gap:15px; font-size:1.05rem; }
    .features li:last-child { border-bottom:none; }
    .features li i.fa-check { color:#14ffec; }
    .features li i.fa-times { color:#ff4d4d; }
    .premium .features li i.fa-check { color:#ffd700; }
    .payment-container { padding:40px 30px; text-align:center; background:rgba(0,0,0,0.2); border-top:1px solid rgba(255,255,255,0.05); }
    .payment-container h2 { margin-bottom:25px; color:#14ffec; font-size:2.2rem; }
    .payment-box { max-width:500px; margin:0 auto; padding:30px; background:rgba(255,255,255,0.03); border-radius:15px; border:1px solid rgba(255,255,255,0.1); box-shadow:0 10px 30px rgba(0,0,0,0.3); }
    #paypalContainer { margin:20px 0; }
    .paypal-note { margin-top:25px; font-size:1rem; color:rgba(255,255,255,0.7); display:flex; justify-content:center; align-items:center; gap:10px; }
    .user-info { margin-top:20px; display:flex; justify-content:center; align-items:center; gap:15px; flex-wrap:wrap; }
    .user-info span { background:rgba(0,0,0,0.3); padding:8px 20px; border-radius:30px; display:flex; align-items:center; gap:8px; font-weight:500; }
    .logout-btn { background:linear-gradient(to right,#ff416c,#ff4b2b); border:none; color:white; cursor:pointer; font-size:1rem; padding:8px 20px; border-radius:30px; display:none; align-items:center; gap:8px; transition:all 0.3s ease; font-weight:500; }
    .logout-btn:hover { background:linear-gradient(to right,#ff4b2b,#ff416c); transform:translateY(-3px); box-shadow:0 5px 15px rgba(255,75,43,0.4); }
    .faq { padding:40px 30px; background:rgba(0,0,0,0.15); }
    .faq h2 { text-align:center; margin-bottom:40px; color:#14ffec; font-size:2.2rem; }
    .faq-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:25px; }
    .faq-item { background:rgba(255,255,255,0.03); border-radius:15px; padding:25px; border:1px solid rgba(255,255,255,0.05); transition:all 0.3s ease; }
    .faq-item:hover { background:rgba(20,255,236,0.05); border-color:rgba(20,255,236,0.2); }
    .faq-item h3 { color:#ffd700; margin-bottom:15px; display:flex; align-items:center; gap:10px; font-size:1.3rem; }
    .faq-item p { color:rgba(255,255,255,0.8); line-height:1.7; }
    .footer { text-align:center; padding:25px; font-size:0.9rem; color:rgba(255,255,255,0.6); border-top:1px solid rgba(255,255,255,0.05); }
    .login-btn { background:linear-gradient(to right,#14ffec,#0d7377); color:#0f3460; border:none; padding:14px 40px; border-radius:50px; font-size:1.1rem; cursor:pointer; font-weight:bold; box-shadow:0 5px 20px rgba(20,255,236,0.3); transition:all 0.3s; }
    .login-btn:hover { transform:translateY(-3px); box-shadow:0 8px 25px rgba(20,255,236,0.4); }
    .retry-btn { background:linear-gradient(to right,#14ffec,#0d7377); color:#0f3460; border:none; padding:12px 30px; border-radius:30px; font-size:1rem; cursor:pointer; font-weight:500; margin-top:10px; }
    .loader { width:50px; height:50px; border:4px solid rgba(20,255,236,0.2); border-top:4px solid #14ffec; border-radius:50%; animation:spin 1.5s linear infinite; margin:0 auto; }
    @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
    @media(max-width:768px){ .plans{grid-template-columns:1fr;} .header h1{font-size:2.2rem;} .price{font-size:2.8rem;} .header{padding-top:70px;} .logo{top:15px;left:15px;} }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">
        <i class="fas fa-crown"></i>
        <span>Image PixMizer</span>
      </div>
      <h1>Upgrade to Premium</h1>
      <p>Unlock the full potential of image processing without limits</p>
      <div class="user-info">
        <span><i class="fas fa-user"></i><span id="userEmail">Not logged in</span></span>
        <button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</button>
      </div>
    </div>

    <div class="plans">
      <div class="plan">
        <h2>Basic</h2>
        <div class="price">Free</div>
        <ul class="features">
          <li><i class="fas fa-check"></i> Process up to 15 images/day</li>
          <li><i class="fas fa-check"></i> Max file size: 7MB</li>
          <li><i class="fas fa-check"></i> Basic quality settings</li>
          <li><i class="fas fa-check"></i> JPG, PNG, WebP formats</li>
          <li><i class="fas fa-check"></i> Basic editing tools</li>
          <li><i class="fas fa-times"></i> Advanced features</li>
          <li><i class="fas fa-times"></i> PDF tools</li>
          <li><i class="fas fa-times"></i> Priority support</li>
        </ul>
      </div>

      <div class="plan premium">
        <div class="recommended-badge pulse"><i class="fas fa-star"></i> Recommended</div>
        <h2>Premium</h2>
        <div class="price">$4.99/mo</div>
        <ul class="features">
          <li><i class="fas fa-check"></i> Unlimited image processing</li>
          <li><i class="fas fa-check"></i> Max file size: 50MB</li>
          <li><i class="fas fa-check"></i> Advanced quality settings</li>
          <li><i class="fas fa-check"></i> All formats: JPG, PNG, WebP, AVIF, HEIC, TIFF</li>
          <li><i class="fas fa-check"></i> Full editing suite</li>
          <li><i class="fas fa-check"></i> Complete PDF tools</li>
          <li><i class="fas fa-check"></i> Batch processing</li>
          <li><i class="fas fa-check"></i> Priority support</li>
          <li><i class="fas fa-check"></i> 30-day money-back guarantee</li>
        </ul>
      </div>
    </div>

    <div class="payment-container">
      <h2>Secure Payment</h2>
      <div class="payment-box">
        <div id="paypalContainer"></div>
      </div>
    </div>

    <div class="faq">
      <h2>FAQ</h2>
      <div class="faq-grid">
        <div class="faq-item"><h3><i class="fas fa-qrcode"></i> How does payment work?</h3><p>Redirect to PayPal → pay → auto upgrade.</p></div>
        <div class="faq-item"><h3><i class="fas fa-sync-alt"></i> Cancel subscription?</h3><p>Yes, anytime via PayPal.</p></div>
        <div class="faq-item"><h3><i class="fas fa-bolt"></i> When do I get Premium?</h3><p>Immediately after payment.</p></div>
        <div class="faq-item"><h3><i class="fas fa-undo"></i> Refund policy?</h3><p>30-day money-back guarantee.</p></div>
      </div>
    </div>

    <div class="footer">
      <p>Contact: korovinkonstantin0@gmail.com</p>
      <p>© 2025 Image PixMizer. All rights reserved.</p>
    </div>
  </div>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCFt14JeU4qGlPScGGXnFdKRwZ8iV8oZQY",
    authDomain: "image-pixmizer.firebaseapp.com",
    projectId: "image-pixmizer",
    storageBucket: "image-pixmizer.appspot.com",
    messagingSenderId: "310177828908",
    appId: "1:310177828908:web:264aa42b38b5cbb50fc189"
  };

  let app, auth, db;
  if (!firebase.apps.length) { app = firebase.initializeApp(firebaseConfig); } else { app = firebase.app(); }
  auth = firebase.auth(); db = firebase.firestore();

  // PayPal init
  function initPayPal(user) {
    paypal.Buttons({
      style:{shape:'pill',color:'gold',label:'paypal',height:50},
      createOrder:(data,actions)=>actions.order.create({
        purchase_units:[{amount:{value:'4.99',currency_code:'USD'},description:'Image PixMizer Premium'}]
      }),
      onApprove:(data,actions)=>actions.order.capture().then(async details=>{
        try {
          await db.collection('users').doc(user.uid).set({
            premium:true,premiumSince:firebase.firestore.Timestamp.now(),
            paymentId:details.id,email:user.email
          },{merge:true});
          document.getElementById('paypalContainer').innerHTML=`<div style="text-align:center"><i class="fas fa-check-circle" style="font-size:3rem;color:#14ffec;"></i><h3>Payment successful!</h3><p>Redirecting...</p><div class="loader"></div></div>`;
          setTimeout(()=>window.location.href='index.html?t='+Date.now(),4000);
        } catch(err){ console.error(err); showPaymentError("Error saving premium status. Try again."); }
      }),
      onError:err=>{ console.error(err); showPaymentError("Payment error. Try again."); }
    }).render('#paypalContainer');
  }

  function showPaymentError(msg){
    document.getElementById('paypalContainer').innerHTML=`<div style="text-align:center;color:#ff4d4d"><i class="fas fa-exclamation-triangle" style="font-size:3rem;"></i><p>${msg}</p><button class="retry-btn" onclick="initPayPal(auth.currentUser)">Retry</button></div>`;
  }

  function showLoginPrompt(){
    document.getElementById('paypalContainer').innerHTML=`<div style="text-align:center"><i class="fas fa-lock" style="font-size:3rem;color:#14ffec;"></i><p>Please log in</p><button class="login-btn" onclick="window.location.href='auth.html'"><i class="fas fa-sign-in-alt"></i> Log In</button></div>`;
  }

  document.addEventListener("DOMContentLoaded",()=>{
    auth.onAuthStateChanged(async user=>{
      if(user){
        document.getElementById("userEmail").textContent=user.email;
        document.getElementById("logoutBtn").style.display="flex";
        try{
          const doc=await db.collection("users").doc(user.uid).get();
          if (doc.exists && doc.data().premium) {
            document.getElementById("paypalContainer").innerHTML = `
              <div style="text-align:center; padding:30px;">
                <i class="fas fa-crown" style="font-size:3rem; color:#ffd700;"></i>
                <h3 style="color:#ffd700;">You are already Premium ✨</h3>
                <p>Enjoy all the features without limits!</p>
              </div>
            `;
          } else {
            initPayPal(user);
          }
        } catch (err) {
          console.error("Error checking premium:", err);
          initPayPal(user);
        }
      } else {
        showLoginPrompt();
      }
    });

    // logout
    document.getElementById("logoutBtn").addEventListener("click", () => {
      auth.signOut().then(() => {
        window.location.href = "auth.html";
      });
    });
  });
</script>
</body>
</html>